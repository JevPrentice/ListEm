<?xml version="1.0" encoding="UTF-8"?>
<ui xmlns="http://uiprogram.mezzanine.com/View" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://uiprogram.mezzanine.com/View ../../xsd/View.xsd">
    <view label="system_report.title" unit="SystemReport" init="init">
    
        <navigation outcome="nav_user_activty" target="UserActivity" />
        <navigation outcome="nav_content_catalogue" target="ContentCatalogue" />
        <navigation outcome="nav_topic_activity_summary" target="TopicActivitySummary" />

        <menuitem label="system_report.title" icon="UserSystemsReport" order="1">
            <userRole>ProgramManager</userRole>
        </menuitem>

        <action label="system_report.nav_content_catalogue" outcome="nav_content_catalogue"/>
        <action label="system_report.nav_topic_activity_summary" outcome="nav_topic_activity_summary"/>

        <table title="system_report.user_activity_summary">
            <collectionSource variable="activeUsers"/>
            <column heading="system_report.user_activity_summary.order">
                <attributeName>order</attributeName>
            </column>
            <column heading="system_report.user_activity_summary.key">
                <attributeName>key</attributeName>
            </column>
            <column heading="system_report.user_activity_summary.value">
                <attributeName>iValue</attributeName>
            </column>
        </table>

        <info label="system_report.numActiveTopics">
            <binding variable="numActiveTopics" />
        </info>

        <!-- <table title="system_report.search_activity_summary">
            <collectionSource variable="searchActivitySummary"/>
            <column heading="system_report.search_activity_summary.key">
                <attributeName>key</attributeName>
            </column>
            <column heading="system_report.search_activity_summary.value">
                <attributeName>iValue</attributeName>
            </column>
        </table> -->

        <table title="system_report.ivr_activity_summary">
            <collectionSource variable="ivrActivitySummary"/>
            <column heading="system_report.ivr_activity_summary.key">
                <attributeName>key</attributeName>
            </column>
            <column heading="system_report.ivr_activity_summary.value">
                <attributeName>iValue</attributeName>
            </column>
        </table>

        <table title="system_report.sms_activity_summary">
            <collectionSource variable="smsActivitySummary"/>
            <column heading="system_report.sms_activity_summary.key">
                <attributeName>key</attributeName>
            </column>
            <column heading="system_report.sms_activity_summary.value">
                <attributeName>iValue</attributeName>
            </column>
        </table>


        <table title="learningManager.TopicHistory.PatternTableTitle">
            <collectionSource function="PatternHistoryList:fGetAllPatternHistorys"/>
            <column heading="learningManager.TopicHistory.Pattern">
                <attributeName>pattern_patternHistory.patternID</attributeName>
            </column>
            <column heading="system_report.channel">
                <attributeName>pattern_patternHistory.PatternChannelKey.patternChannelDescription</attributeName>
            </column>
            <column heading="learningManager.TopicHistory.Client">
                <attributeName>client_patternHistory.mobileNumber</attributeName>
                <attributeName>client_patternHistory.firstName</attributeName>
            </column>
            <column heading="learningManager.TopicHistory.startDate">
                <attributeName>startDate</attributeName>
            </column>
            <column heading="learningManager.TopicHistory.reminderTime">
                <attributeName>reminderTime</attributeName>
            </column>
            <column heading="learningManager.TopicHistory.actualEndDate">
                <attributeName>actualEndDate</attributeName>
            </column>
            <column heading="learningManager.TopicHistory.statusID">
                <attributeName>statusID</attributeName>
            </column>
            <rowAction label="system_report.view_user_activity" action="viewUserActivity">
                <binding variable="activityHistory"/>
            </rowAction>
        </table>
 
        <table title="ScheduleURL.fGetAllScheduleURL">
            <collectionSource function="uMonitoring:fGetAllScheduleURL"/>
            <column heading="ScheduleURL.dateTimeStampInserted">
                <attributeName>dateTimeStampInserted</attributeName>
            </column>            
            <column heading="ScheduleURL.url">
                <attributeName>url</attributeName>
            </column>            
            <column heading="ScheduleURL.dateTimeStampUsed">
                <attributeName>dateTimeStampUsed</attributeName>
            </column>            
            <column heading="ScheduleURL.status">
                <attributeName>status</attributeName>
            </column>            
        </table>

        <table title="AllSMSLog.PendingSMSqueue">
            <collectionSource function="uMonitoring:fGetAllPendingSMSQueue"/>
            <column heading="AllSMSLog.dateTimeStamp">
                <attributeName>smsDateTime</attributeName>
            </column>
            <column heading="AllSMSLog.mobileNumber">
                <attributeName>c_clientsmsqueue.mobileNumber</attributeName>
                <attributeName>c_clientsmsqueue.firstName</attributeName>
            </column>
              <column heading="AllSMSLog.messageText">
                <attributeName>smsText</attributeName>
            </column>
        </table>

        <submit label="refresh" action="init"/>
        <submit label="system_settings.ivrScheduleWatch" action="ScheduledActions:ivrScheduleWatch"/>

    </view>
</ui>