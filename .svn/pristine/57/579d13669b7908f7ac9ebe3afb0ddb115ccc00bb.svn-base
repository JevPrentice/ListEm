<?xml version="1.0" encoding="UTF-8"?>
<ui xmlns="http://uiprogram.mezzanine.com/View" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://uiprogram.mezzanine.com/View ../../xsd/View.xsd">
    <view label="GroupTopicScheduling.title" unit="GroupTopicScheduling" init="init">

        <menuitem label="TopicScheduling" icon="TopicScheduling" order="4">
            <userRole>LearningManager</userRole>
            <userRole>ProgramManager</userRole>
        </menuitem>

        <navigation outcome="UserTopicScheduling" target="UserTopicScheduling" />
        <navigation outcome="TopicReschedule" target="TopicReschedule" />

        <action label="UserTopicScheduling" outcome="UserTopicScheduling" />
        <action label="RescheduleTopic" outcome="TopicReschedule" />

        <submit label="run" action="ScheduledActions:chewGroupTopicPreStartReminder"/>

        <select label="groups">
            <binding variable="selectedGroup"/>
            <collectionSource function="UserGroupController:getAllClientGroups">
                <displayAttribute name="name"/>
            </collectionSource>
        </select>

        <select label="topic.topicID">
            <binding variable="selectedTopic"/>
            <collectionSource function="TopicController:getAllTopicsNotMarkedNoReport">
                <displayAttribute name="umbrellaID" />
            </collectionSource>
        </select>

        <datefield label="TopicScheduling.startdate">
            <binding variable="dStartDateTime" />
        </datefield>
        
        <checkbox label="TopicScheduling.startNow">
            <binding variable="bIgnoreDefaultTime" />
        </checkbox> 

        <submit label="GroupTopicScheduling.scheduleGroup" action="scheduleGroupForTopic"/>
        <submit label="GroupTopicScheduling.clearGroupSchedule" action="clearGroupForTopic"/>
        <submit label="GroupTopicScheduling.runScheduledStartForGroup" action="runScheduledStartForGroup"/>

        <table title="learningManager.topicUserList.list">
            <collectionSource variable="tusArr"/>
            <column heading="topicUser.topicUserID">
                <attributeName>client_topicUserSetup.firstName</attributeName>
                <attributeName>client_topicUserSetup.surname</attributeName>
                <attributeName>client_topicUserSetup.mobileNumber</attributeName>
            </column>

            <column heading="topic.topicID">
                <attributeName>umbrella_topicUserSetup.umbrellaID</attributeName>
            </column>
                        
            <column heading="sub_topic.subTopicID">
                <attributeName>topic_topicUserSetup.topicID</attributeName>
            </column>
         
             <column heading="topicUser.topicOrder">
                <attributeName>topicOrder</attributeName>
            </column> 
            
            <column heading="topic.active">
                <attributeName>active</attributeName>
            </column> 

            <column heading="sub_topic.subTopicRunType">
                <attributeName>runType</attributeName>
            </column> 

            <column heading="topicUser.topicMinStartDate">
                <attributeName>topicMinStartDate</attributeName>
            </column> 

            <rowAction label="start" action="startUserOnTopic">
                <binding variable="startTus"/>
                <confirm subject="confirm_subject.fStartTopicUserSetup" body="confirm_body.fStartTopicUserSetup"/>
            </rowAction>          
            <rowAction label="end" action="endTopicUserSetup">
                <binding variable="removeTus"/>
                <confirm subject="confirm_subject.deleteTopicUserSetup" body="confirm_body.deleteTopicUserSetup"/>
            </rowAction>
        </table>

        <info label="TopicScheduling.tusFilterApplied">
            <binding variable="tusFilter" />
        </info>

        <submit label="TopicScheduling.showAllTus" action="showAllTus"/>
        <submit label="TopicScheduling.showTusForGroup" action="showTusForGroup"/>

    </view>
</ui>

