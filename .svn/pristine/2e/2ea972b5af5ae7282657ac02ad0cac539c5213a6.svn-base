<?xml version="1.0" encoding="UTF-8"?>
<ui xmlns="http://uiprogram.mezzanine.com/View" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://uiprogram.mezzanine.com/View ../../xsd/View.xsd">
    <view label="UserScheduleSummary" unit="SubTopicUserScheduling" init="init">
  
        <navigation outcome="navSubTopicUserScheduleEdit" target="SubTopicUserScheduleEdit" />
        <navigation outcome="navGroupScheduling" target="SubTopicGroupScheduling" />

        <menuitem label="SubTopicScheduling" icon="SubTopicScheduling" order="5">
            <userRole>LearningManager</userRole>
            <userRole>ProgramManager</userRole>
        </menuitem>
        
        <action label="SubTopicUserScheduling.navTusEdit" action="navTusCreate"/>
        <action label="GroupScheduling" outcome="navGroupScheduling"/>

        <info label="TopicScheduling.tusFilterType">
            <binding variable="tusFilter" />
        </info>
        
        <info label="TopicScheduling.tusFilterApplied">
            <binding variable="tusFilterMsg" />
        </info>

        <submit label="reset" action="reset"/>
        <submit label="update" action="filterTus"/>

        <select label="group">
            <binding variable="selectedGroup"/>
    		<collectionSource function="UserGroupController:getAllClientGroups">
				<displayAttribute name="name"/>
			</collectionSource>
		</select>

        <submit label="SubTopicUserScheduling.showUsersForGroup" action="showUsersForGroup"/>

        <select label="user">
            <binding variable="selectedUser"/>
            <collectionSource variable="userArr">
                <displayAttribute name="firstName"/>
                <displayAttribute name="surname"/>
                <displayAttribute name="mobileNumber"/>
            </collectionSource>
        </select>

        <select label="topic">
            <binding variable="selectedTopic"/>
            <collectionSource function="TopicController:getAllTopicsNotMarkedNoReport">
                <displayAttribute name="umbrellaID"/>
            </collectionSource>
        </select>

        <submit label="SubTopicUserScheduling.showSubTopicsForTopic" action="showSubTopicsForTopic"/>

        <select label="sub_topic.subTopicID">
            <binding variable="selectedSubTopic"/>
            <collectionSource variable="subTopicArr">
                <displayAttribute name="topicID"/>
            </collectionSource>
        </select>

        <submit label="TopicScheduling.showAllTus" action="showAllTus"/>
        <submit label="TopicScheduling.showTusForGroup" action="showTusForGroup"/>
        <submit label="TopicScheduling.showTusForUser" action="showTusForUser"/>
        <submit label="TopicScheduling.showTusForSubTopic" action="showTusForSubTopic"/>

        <table title="SubTopicUserScheduling.tus">
            <collectionSource variable="tusArr"/>
            <column heading="topicUser.topicUserID">
                <attributeName>client_topicUserSetup.mobileNumber</attributeName>
                <attributeName>client_topicUserSetup.firstName</attributeName>
                <attributeName>client_topicUserSetup.surname</attributeName>
            </column>

            <column heading="topic.topicID">
                <attributeName>umbrella_topicUserSetup.umbrellaID</attributeName>
            </column>

         	<column heading="sub_topic.subTopicID">
                <attributeName>topic_topicUserSetup.topicID</attributeName>
            </column>

            <column heading="sub_topic.subTopicType">
                <attributeName>topic_topicUserSetup.topicType</attributeName>
            </column>

             <column heading="topicUser.topicOrder">
                <attributeName>topicOrder</attributeName>
            </column> 
            
            <column heading="topic.active">
                <attributeName>active</attributeName>
            </column> 

            <column heading="sub_topic.subTopicRunType">
                <attributeName>runType</attributeName>
            </column> 

            <column heading="topicUser.topicMinStartDate">
                <attributeName>topicMinStartDate</attributeName>
            </column>
            
            <rowAction label="edit" action="editSelectedTus">
                <binding variable="tusEdit"/>
            </rowAction>
            <rowAction label="remove" action="deleteSelectedTus">
                <binding variable="tusDelete"/>
                <confirm subject="confirm_subject.deleteTopicUserSetup" body="confirm_body.deleteTopicUserSetup"/>
            </rowAction>
            <rowAction label="start" action="startSelectedTus">
                <binding variable="tusStart"/>
                <confirm subject="confirm_subject.fStartTopicUserSetup" body="confirm_body.fStartTopicUserSetup"/>
            </rowAction>
             <rowAction label="pause" action="pauseSelectedTus">
                <binding variable="tusPause"/>
            </rowAction>
             <rowAction label="resume" action="resumeSelectedTus">
                <binding variable="tusResume"/>
            </rowAction>
             <rowAction label="end" action="endSelectedTus">
                <binding variable="tusEnd"/>
                <confirm subject="confirm_subject.ForceTopicUserEnd" body="confirm_body.ForceTopicUserEnd"/>
            </rowAction>
        </table>

        <submit label="SubTopicUserScheduling.clearUserSubTopicHistory" action="clearTopicHistory"/>
        
    </view>
</ui>