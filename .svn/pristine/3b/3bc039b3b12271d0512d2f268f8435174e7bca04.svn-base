unit ManageNpm;

Npm uNpm;
bool editing; //Flag (mode) : edit|save

void init(){
    uNpm = createNpm();
	editing = false;
}


/* submit for form: if editing stay at same view */
string saveNpm(){
	if(editing == true){
		editing = false;		
		Mez:alert("edited_confirmation.npm");
		uNpm = createNpm();	
		return null;
	}
	
	Npm [] npms = Npm:equals(deleted, "no");
	for(int i = 0; i < npms.length(); i++){
		Npm curNpm = npms.get(i);
		if(curNpm.npmid == uNpm.npmid){
			Mez:alertError("error.duplicate_npm_id");
			return null;
		}
	}
	
	return "saved";
}


/* final submit for user creation: save the instance and invite the user */
string inviteNpm(){
	uNpm.save();
	uNpm = createNpm();
	Mez:alert("invited_confirmation.npm");
	return "invited";
}


/* callback for edit row action: set mode to editing and stay at same view */
string editNpm(){
	editing = true;	
	return null;
}


/* call back for delete npm row action */
string deleteNpm(){
	uNpm.deleted = "yes";
	uNpm.removeRole();
	Mez:alert("deleted_confirmation.npm");	
	uNpm = createNpm();
	return null;
}


/* create and return a default instance of Npm */
Npm createNpm(){
	Npm npm = Npm:new();
	npm.deleted = "no";
	return npm;
}